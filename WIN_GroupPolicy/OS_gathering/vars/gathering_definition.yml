---
command:
  - $keylist = @(); foreach ($filepath in (Get-ChildItem C:\Windows\PolicyDefinitions\*.admx -Name)){$admfile=[xml](Get-Content C:\Windows\PolicyDefinitions\$filepath); $keylist += @($admfile.policyDefinitions.policies.policy | Select-Object key,class -unique| Where-Object{$_.class -eq "Machine"} | format-List key | Out-String -Stream | Where-Object{$_ -ne ""} | foreach{"HKLM\" + $_.Remove(0,6)}; $admfile.policyDefinitions.policies.policy | Select-Object key,class -unique| Where-Object{$_.class -eq "User"} | format-List key | Out-String -Stream | Where-Object{$_ -ne ""} | foreach{"HKCU\" + $_.Remove(0,6)}; $admfile.policyDefinitions.policies.policy | Select-Object key,class -unique| Where-Object{$_.class -eq "Both"} | format-List key | Out-String -Stream | Where-Object{$_ -ne ""} | foreach{"HKLM\" + $_.Remove(0,6); "HKCU\" + $_.Remove(0,6)}) | Select-Object -Unique}; $data = New-Object PSObject; foreach($a in $keylist){ $data | Add-Member -MemberType NoteProperty -name $a -Value (Get-ItemProperty "registry::$a" | Select-Object * -ExcludeProperty "PSPath", "PSParentPath", "PSChildName", "PSProvider") }; Write-output $data | ConvertTo-Json
  - $keylist = @(); foreach ($filepath in (Get-ChildItem C:\Windows\PolicyDefinitions\*.admx -Name)){$admfile=[xml](Get-Content C:\Windows\PolicyDefinitions\$filepath); $keylist += @($admfile.policyDefinitions.policies.policy | Select-Object key,class -unique| Where-Object{$_.class -eq "Machine"} | format-List key | Out-String -Stream | Where-Object{$_ -ne ""} | foreach{"HKLM\" + $_.Remove(0,6)}; $admfile.policyDefinitions.policies.policy | Select-Object key,class -unique| Where-Object{$_.class -eq "User"} | format-List key | Out-String -Stream | Where-Object{$_ -ne ""} | foreach{"HKCU\" + $_.Remove(0,6)}; $admfile.policyDefinitions.policies.policy | Select-Object key,class -unique| Where-Object{$_.class -eq "Both"} | format-List key | Out-String -Stream | Where-Object{$_ -ne ""} | foreach{"HKLM\" + $_.Remove(0,6); "HKCU\" + $_.Remove(0,6)}) | Select-Object -Unique}; foreach($a in $keylist){ reg query $a /ve; foreach($b in (Get-Item -Path "registry::$a" | Select-Object -ExpandProperty Property)){reg query $a /v $b}}
