---
command:
  - $data = New-Object PSObject; $data | Add-Member -MemberType NoteProperty -name "HKLM\SYSTEM\CurrentControlSet\services\SNMP" -Value (Get-ItemProperty "registry::HKLM\SYSTEM\CurrentControlSet\services\SNMP" | Select-Object * -ExcludeProperty "PSPath", "PSParentPath", "PSChildName", "PSProvider"); Write-output $data | ConvertTo-Json
  - $a = "HKLM\SYSTEM\CurrentControlSet\services\SNMP"; reg query $a /ve; foreach($b in (Get-Item -Path "registry::$a" | Select-Object -ExpandProperty Property)){reg query $a /v $b}
  - $data = New-Object PSObject; foreach($a in (Get-ChildItem "registry::HKLM\SYSTEM\CurrentControlSet\services\SNMP" -Recurse | Select-Object pspath | ConvertTo-Csv | Where-Object{$_ -ne "#TYPE Selected.Microsoft.Win32.RegistryKey" -and $_ -ne """PSPath"""} | foreach{$_.Remove(0,37)} | foreach{$_.Trim("""")})){ $data | Add-Member -MemberType NoteProperty -name $a -Value (Get-ItemProperty "registry::$a" | Select-Object * -ExcludeProperty "PSPath", "PSParentPath", "PSChildName", "PSProvider") }; Write-output $data | ConvertTo-Json
  - foreach($a in (Get-ChildItem "registry::HKLM\SYSTEM\CurrentControlSet\services\SNMP" -Recurse | Select-Object pspath | ConvertTo-Csv | Where-Object{$_ -ne "#TYPE Selected.Microsoft.Win32.RegistryKey" -and $_ -ne """PSPath"""} | foreach{$_.Remove(0,37)} | foreach{$_.Trim("""")})){ reg query $a /ve; foreach($b in (Get-Item -Path "registry::$a" | Select-Object -ExpandProperty Property)){reg query $a /v $b}}

